<div class="container">
    <form #lancamentoForm="ngForm" autocomplete="off" (ngSubmit)="salvar(lancamentoForm)">

        <div class="p-grid">
            <div class="p-col-12">
                <h1>Novo Lançamento</h1>
            </div>

            <div class="p-col-12">
                <p-selectButton [options]="tipos" #tipo name="tipo"
                [(ngModel)]="lancamento.tipo">
                </p-selectButton>
            </div>

            <div class="p-fluid p-col-6 p-md-3">
                <label>Vencimento</label>
                <p-calendar dateFormat="dd/mm/yy"
                            [inline]="false"
                            [readonlyInput]="false"
                            [showIcon]="false"
                            #vencimento="ngModel"
                            name="vencimento"
                            [(ngModel)]="lancamento.dataVencimento"
                            [required]="true">
                </p-calendar>

                <app-message [control]="vencimento" error="required"
                             text="Informe uma data de vencimento"></app-message>
            </div>

            <div class="p-fluid p-col-6 p-md-3">
                <label>{{ tipo.value === 'RECEITA' ? 'Recebimento' : 'Pagamento' }}</label>
                <p-calendar dateFormat="dd/mm/yy" name="dataPagamento"
                            [(ngModel)]="lancamento.dataPagamento">
                </p-calendar>
            </div>

            <div class="p-fluid p-col-12 p-md-9">
                <label>Descrição</label>
                <input pInputText
                       type="text"
                       name="descricao"
                       [(ngModel)]="lancamento.descricao" #descricao="ngModel"
                       required minlength="5">

                <app-message [control]="descricao" error="required"
                             text="Informe uma descrição">
                </app-message>
                <app-message [control]="descricao" error="minlength"
                             text="Mínimo de {{ descricao.errors?.['minlength']?.requiredLength }} caracteres.">
                </app-message>

            </div>

            <div class="p-fluid p-col-12 p-md-3">
                <label>Valor</label>
                <p-inputNumber mode="currency"
                               currency="BRL"
                               locale="pt-BR"
                               placeholder="R$ 0,00"
                               name="valor"
                               [(ngModel)]="lancamento.valor"
                               #valor="ngModel"
                               [required]="true"></p-inputNumber>

                <app-message [control]="valor" error="required"
                             text="Informe uma valor"></app-message>
            </div>

            <div class="p-fluid p-col-12 p-md-6">
                <label>Categoria</label>
                <p-dropdown [options]="categorias"
                            placeholder="Selecione uma categoria"
                            [(ngModel)]="lancamento.categoria.id"
                            name="categoria"
                            [required]="true">
                </p-dropdown>
            </div>

            <div class="p-fluid p-col-12 p-md-6">
                <label>Pessoa</label>
                <p-dropdown [options]="pessoas"
                            placeholder="Selecione uma pessoa"
                            [filter]="true"
                            name="pessoa"
                            [(ngModel)]="lancamento.pessoa.id"
                            #pessoa
                            [required]="true">
                </p-dropdown>
            </div>

            <div class="p-fluid p-col-12">
                <label>Observação</label>
                <textarea pInputTextarea rows="3"
                          name="observacao"
                          [(ngModel)]="lancamento.observacao"></textarea>
            </div>

            <div class="p-col-12">
                <button pButton type="submit" label="Salvar" [disabled]="lancamentoForm.invalid"></button>
                <button pButton type="button" label="Novo" class="p-button-info"></button>
                <a href="javascript:;">Voltar para a pesquisa</a>
            </div>
        </div>
    </form>
</div>
